# Anime List Organizer API

![Version](https://img.shields.io/badge/version-3.0.0-blue.svg)
![Status](https://img.shields.io/badge/status-active-success.svg)
![Node](https://img.shields.io/badge/node-%3E=18.x-green)
![TypeScript](https://img.shields.io/badge/types-TypeScript-informational)
![License](https://img.shields.io/badge/license-Apache%202.0-orange)
![PRs](https://img.shields.io/badge/PRs-welcome-brightgreen.svg)
![Issues](https://img.shields.io/github/issues/GabrielFinotti/anime-list-organizer-api)
![Last Commit](https://img.shields.io/github/last-commit/GabrielFinotti/anime-list-organizer-api)

API REST para gerenciamento e organiza√ß√£o de animes, com lookup inteligente via OpenAI e suporte a categorias, g√™neros e g√™neros adultos.

[Reportar Bug](https://github.com/GabrielFinotti/anime-list-organizer-api/issues) ¬∑ [Solicitar Feature](https://github.com/GabrielFinotti/anime-list-organizer-api/issues)

## üìã Sum√°rio

- [Vis√£o Geral](#vis√£o-geral)
- [Stack Tecnol√≥gico](#stack-tecnol√≥gico)
- [Arquitetura](#arquitetura)
- [Instala√ß√£o](#instala√ß√£o)
- [Configura√ß√£o](#configura√ß√£o)
- [Uso](#uso)
- [Modelos de Dados](#modelos-de-dados)
- [Endpoints](#endpoints)
- [Autentica√ß√£o](#autentica√ß√£o)
- [Scripts](#scripts)
- [Contribui√ß√£o](#contribui√ß√£o)
- [Licen√ßa](#licen√ßa)

## ‚ú® Vis√£o Geral

Esta API permite criar, atualizar, listar e remover animes do seu cat√°logo pessoal, al√©m de realizar consultas autom√°ticas (lookup) que retornam metadados normalizados usando o modelo GPT-4o-mini da OpenAI com ferramenta de busca web. Suporta organiza√ß√£o por categorias, g√™neros e g√™neros adultos, facilitando a cataloga√ß√£o e descoberta de conte√∫do.

## üß± Stack Tecnol√≥gico

- **Node.js** (>= 18.x)
- **Express.js** (Framework web)
- **TypeScript** (Tipagem est√°tica)
- **MongoDB** (Banco de dados NoSQL)
- **Mongoose** (ODM para MongoDB)
- **OpenAI SDK** (Integra√ß√£o com IA para lookup)
- **Zod** (Valida√ß√£o de schemas - preparado para uso futuro)
- **jsonwebtoken** (Preparado para autentica√ß√£o JWT futura)

## üóÇ Arquitetura

A API segue o padr√£o MVC (Model-View-Controller) com separa√ß√£o clara de responsabilidades:

```
src/
‚îú‚îÄ‚îÄ controller/     # Controladores HTTP (manipulam requests/responses)
‚îú‚îÄ‚îÄ service/        # L√≥gica de neg√≥cio e orquestra√ß√£o
‚îú‚îÄ‚îÄ repository/     # Abstra√ß√£o de acesso a dados
‚îú‚îÄ‚îÄ model/          # Schemas Mongoose e entidades
‚îú‚îÄ‚îÄ router/         # Defini√ß√£o de rotas
‚îú‚îÄ‚îÄ middleware/     # Middlewares Express (vazio atualmente)
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îî‚îÄ‚îÄ openai/     # Integra√ß√£o com OpenAI para lookup
‚îú‚îÄ‚îÄ interface/
‚îÇ   ‚îú‚îÄ‚îÄ dto/        # Data Transfer Objects
‚îÇ   ‚îî‚îÄ‚îÄ repository/ # Interfaces de reposit√≥rio
‚îú‚îÄ‚îÄ utils/          # Utilit√°rios diversos
‚îî‚îÄ‚îÄ server.ts       # Ponto de entrada da aplica√ß√£o
```

## üöÄ Instala√ß√£o

### Pr√©-requisitos

- Node.js >= 18.x
- MongoDB (local ou Atlas)
- Conta OpenAI com API Key

### Passos

1. **Clone o reposit√≥rio:**

   ```bash
   git clone https://github.com/GabrielFinotti/anime-list-organizer-api.git
   cd anime-list-organizer-api
   ```

2. **Instale as depend√™ncias:**

   ```bash
   npm install
   ```

3. **Configure as vari√°veis de ambiente** (veja se√ß√£o [Configura√ß√£o](#-configura√ß√£o))

4. **Execute em desenvolvimento:**

   ```bash
   npm run dev
   ```

5. **Ou build e execute em produ√ß√£o:**

   ```bash
   npm run build
   npm start
   ```

A aplica√ß√£o estar√° dispon√≠vel em `http://localhost:{PORT}/api/v3`

## ‚öôÔ∏è Configura√ß√£o

### Vari√°veis de Ambiente

Crie um arquivo `.env` na raiz do projeto com as seguintes vari√°veis:

| Vari√°vel | Obrigat√≥ria | Descri√ß√£o | Exemplo |
|----------|-------------|-----------|---------|
| `PORT` | ‚úÖ | Porta do servidor Express | `3333` |
| `MONGODB_URI` | ‚úÖ | String de conex√£o MongoDB | `mongodb://localhost:27017/anime-db` |
| `OPENAI_API_KEY` | ‚úÖ | Chave da API OpenAI | `sk-xxxxx` |
| `VERSION` | ‚ùå | Vers√£o da API (padr√£o: v3) | `v3` |

**Exemplo de `.env`:**

```env
PORT=3333
MONGODB_URI=mongodb://localhost:27017/anime-list-organizer
OPENAI_API_KEY=sk-your-openai-api-key-here
VERSION=v3
```

### MongoDB

Certifique-se de que o MongoDB esteja rodando localmente ou configure uma conex√£o com MongoDB Atlas.

## üìñ Uso

### Formato de Resposta

Todas as respostas seguem o padr√£o consistente:

```json
{
  "success": true,
  "statusCode": 200,
  "message": "Opera√ß√£o realizada com sucesso",
  "data": {}
}
```

Em caso de erro:

```json
{
  "success": false,
  "statusCode": 400,
  "message": "Descri√ß√£o do erro",
  "data": null
}
```

### C√≥digos de Status

- `200` - OK (opera√ß√µes bem-sucedidas)
- `201` - Created (cria√ß√£o de recursos)
- `400` - Bad Request (dados inv√°lidos)
- `404` - Not Found (recurso n√£o encontrado)
- `409` - Conflict (conflito, ex.: nome duplicado)
- `500` - Internal Server Error (erro interno)

## üìä Modelos de Dados

### Anime

```typescript
{
  id?: string;
  name: string;                    // Nome do anime
  synopsis: string;                // Sinopse
  category: CategoryDTO;           // Categoria (ex.: Shounen)
  genres: GenreDTO[];              // Lista de g√™neros
  adultGenres: AdultGenreDTO[];    // Lista de g√™neros adultos (opcional)
  typeOfMaterialOrigin: string;    // Origem (ex.: Manga, Light Novel)
  materialOriginName: string;      // Nome da obra original
  releaseDate: string;             // Data de lan√ßamento (YYYY-MM-DD)
  isMovie: boolean;                // √â um filme?
  isAdult: boolean;                // Conte√∫do adulto?
  derivate?: {                     // Derivados (opcional)
    movies: string[];
    ovas: string[];
    specials: string[];
  };
  lastReleaseSeason: number;       // √öltima temporada lan√ßada
  lastWatchedSeason: number;       // √öltima temporada assistida
  lastWatchedEpisode: number;      // √öltimo epis√≥dio assistido
  actualStatus: "publishing" | "completed" | "cancelled" | "in production";
  status: "watching" | "completed" | "in list" | "dropped";
}
```

### Category

```typescript
{
  id?: string;
  name: string;              // Nome da categoria
  translatedName: string;    // Nome traduzido
  targetAudience: string;    // P√∫blico-alvo
  characteristics: string[]; // Caracter√≠sticas
}
```

### Genre

```typescript
{
  id?: string;
  name: string;              // Nome do g√™nero
  characteristics: string[]; // Caracter√≠sticas
}
```

### AdultGenre

```typescript
{
  id?: string;
  name: string;              // Nome do g√™nero adulto
  characteristics: string[]; // Caracter√≠sticas
}
```

## üîó Endpoints

**Prefixo base:** `/api/v3`

### Animes

#### Listar todos os animes

`GET /animes`

**Query Parameters (opcionais):**

- `name`: Filtrar por nome
- `category`: Filtrar por categoria
- `genre`: Filtrar por g√™nero

**Resposta 200:**

```json
{
  "success": true,
  "statusCode": 200,
  "message": "Animes retrieved successfully",
  "data": [...]
}
```

#### Obter anime por ID

`GET /animes/{id}`

**Erros:** 400 (ID inv√°lido), 404 (n√£o encontrado)

#### Buscar por categoria

`GET /animes/category/{categoryName}`

#### Buscar por g√™nero

`GET /animes/genre/{genreName}`

#### Buscar por g√™nero adulto

`GET /animes/adult-genre/{adultGenreName}`

#### Criar anime

`POST /animes`

**Body:** Objeto AnimeDTO (ver [Modelos de Dados](#-modelos-de-dados))

**Resposta 201:** Anime criado

#### Atualizar anime

`PUT /anime/update/{id}`

**Body:** Objeto AnimeDTO parcial

#### Remover anime por ID

`DELETE /anime/delete/{id}`

#### Remover todos os animes

`DELETE /animes/delete-all`

### Categorias

#### Listar todas

`GET /categories`

#### Criar categoria (Admin)

`POST /category`

**Body:** Objeto CategoryDTO

#### Remover categoria (Admin)

`DELETE /category/{id}`

### G√™neros

#### Listar todos

`GET /genres`

#### Criar g√™nero (Admin)

`POST /genre`

**Body:** Objeto GenreDTO

#### Remover g√™nero (Admin)

`DELETE /genre/{id}`

### G√™neros Adultos

#### Listar todos

`GET /adult-genres`

#### Criar g√™nero adulto (Admin)

`POST /adult-genre`

**Body:** Objeto AdultGenreDTO

#### Remover g√™nero adulto (Admin)

`DELETE /adult-genre/{id}`

### Lookup (OpenAI)

#### Buscar metadados de anime

`GET /anime/lookup?title={nome}`

**Par√¢metros:**

- `title`: Nome do anime (obrigat√≥rio, m√≠nimo 1 caractere)

**Resposta 200:**

```json
{
  "success": true,
  "statusCode": 200,
  "message": "Dados do anime encontrados com sucesso",
  "data": {
    "name": "Nome Oficial",
    "synopsis": "Sinopse em portugu√™s",
    "category": { "name": "Categoria" },
    "genres": [{ "name": "G√™nero1" }],
    "adultGenres": [],
    // ... outros campos
  }
}
```

Este endpoint utiliza GPT-5-mini com busca web para obter metadados precisos e normalizados.

## üîê Autentica√ß√£o

**Nota:** A autentica√ß√£o n√£o est√° implementada nesta vers√£o. Os endpoints est√£o abertos para desenvolvimento/teste.

**Planejado para futuras vers√µes:**

- Autentica√ß√£o Basic Auth
- JWT para sess√µes
- Controle de acesso baseado em roles

## üìú Scripts

| Comando | Descri√ß√£o |
|---------|-----------|
| `npm run dev` | Executa em modo desenvolvimento com hot-reload (tsx) |
| `npm run build` | Gera build otimizado em `dist/` via tsup |
| `npm start` | Executa build gerado (`node dist/server.js`) |
| `npm run typecheck` | Verifica tipos TypeScript |

## üß© Padr√µes e Decis√µes

- **Valida√ß√£o:** Preparado para usar Zod em DTOs e schemas
- **Respostas consistentes:** Padr√£o uniforme em todas as respostas
- **Separa√ß√£o de camadas:** MVC facilita manuten√ß√£o e testes
- **Lookup inteligente:** OpenAI com busca web para metadados precisos
- **Normaliza√ß√£o:** Dados retornados em portugu√™s brasileiro
- **√çndices:** Campos cr√≠ticos indexados no MongoDB
- **Refer√™ncias:** Uso de ObjectIds para relacionamentos

## üõ° Roadmap

- ‚úÖ CRUD completo para animes
- ‚úÖ Lookup via OpenAI
- ‚úÖ Suporte a categorias, g√™neros e g√™neros adultos
- üîÑ Implementar autentica√ß√£o (Basic Auth/JWT)
- üîÑ Adicionar testes unit√°rios e integra√ß√£o
- üîÑ Implementar pagina√ß√£o e filtros avan√ßados
- üîÑ Cache para resultados de lookup (Redis)
- üîÑ Rate limiting e prote√ß√£o contra abuso
- üîÑ Observabilidade (logs, m√©tricas)
- üîÑ Docker e Compose
- üîÑ Documenta√ß√£o interativa (Swagger)
- üîÑ Endpoints para Manga

## ü§ù Contribui√ß√£o

1. Fork o projeto
2. Crie uma branch para sua feature: `git checkout -b feature/nova-funcionalidade`
3. Commit suas mudan√ßas: `git commit -m 'feat: adiciona nova funcionalidade'`
4. Push para a branch: `git push origin feature/nova-funcionalidade`
5. Abra um Pull Request

### Conven√ß√µes de Commit

- `feat:` - Nova funcionalidade
- `fix:` - Corre√ß√£o de bug
- `docs:` - Mudan√ßas na documenta√ß√£o
- `style:` - Mudan√ßas de formata√ß√£o
- `refactor:` - Refatora√ß√£o de c√≥digo
- `test:` - Adi√ß√£o ou corre√ß√£o de testes
- `chore:` - Mudan√ßas em ferramentas/configura√ß√µes

## üìÑ Licen√ßa

Distribu√≠do sob a licen√ßa **Apache 2.0**. Consulte o arquivo `LICENSE` para mais detalhes.

---

Feito com ‚òï por [Gabriel Finotti](https://github.com/GabrielFinotti). Sugest√µes e PRs s√£o bem-vindos!
